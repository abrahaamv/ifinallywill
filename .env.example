# =============================================================================
# ENVIRONMENT CONFIGURATION TEMPLATE
# =============================================================================
#
# INSTRUCTIONS:
# 1. Copy this file to .env.local: cp .env.example .env.local
# 2. Replace placeholder values with actual credentials
# 3. NEVER commit .env.local to git
#
# Generate strong secrets:
# node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# =============================================================================

# =============================================================================
# Application URLs (environment-specific - REQUIRED for CORS)
# =============================================================================
NODE_ENV=development
APP_URL=http://localhost:5173
DASHBOARD_URL=http://localhost:5174
MEET_URL=http://localhost:5175
WIDGET_URL=http://localhost:5176

# Staging Example:
# NODE_ENV=staging
# APP_URL=https://staging.platform.com
# DASHBOARD_URL=https://staging-dashboard.platform.com
# MEET_URL=https://staging-meet.platform.com
# WIDGET_URL=https://staging.platform.com/widget

# Production Example:
# NODE_ENV=production
# APP_URL=https://www.platform.com
# DASHBOARD_URL=https://dashboard.platform.com
# MEET_URL=https://meet.platform.com
# WIDGET_URL=https://www.platform.com/widget

# =============================================================================
# API Configuration
# =============================================================================
API_PORT=3001
REALTIME_PORT=3002

# =============================================================================
# Database Configuration
# =============================================================================
DATABASE_URL="postgresql://ifinallywill:ifinallywill_dev_password@localhost:5432/ifinallywill"

# Service role with BYPASS RLS for admin operations (registration, system tasks)
# ⚠️ CRITICAL: Use ONLY for administrative operations, never for user queries
SERVICE_DATABASE_URL="postgresql://ifinallywill_service:ifinallywill_dev_password@localhost:5432/ifinallywill"

REDIS_URL="redis://:ifinallywill_redis_password@localhost:6379"

# =============================================================================
# Authentication (Auth.js / NextAuth.js)
# ============================================================================
# Auth.js replaces deprecated Lucia v4 (March 2025)
#
# CRITICAL SETUP NOTES:
# - NEXTAUTH_URL = Backend API server URL (port 3001)
# - Frontend apps (ports 5173-5176) use Vite proxy to make requests same-origin
# - Vite proxy rewrites cookies (removes Secure flag for HTTP localhost)
# - All /api/* requests are proxied from frontend to backend
# - Credentials provider uses manual session creation (see auth/config.ts)
# - trustHost: true required for proxy setup
NEXTAUTH_URL="http://localhost:3001"
NEXTAUTH_SECRET="<GENERATE_32_CHAR_RANDOM_STRING>"

# OAuth Providers (Google REQUIRED, Microsoft optional)
GOOGLE_CLIENT_ID="your-google-oauth-client-id.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="your-google-oauth-client-secret"

# Microsoft OAuth (Enterprise customers - optional)
MICROSOFT_CLIENT_ID="your-azure-app-client-id"
MICROSOFT_CLIENT_SECRET="your-azure-app-client-secret"
MICROSOFT_TENANT_ID="your-azure-tenant-id"

# ============================================================================
# Security Secrets (Phase 8 - REQUIRED in Production)
# ============================================================================
# MFA Encryption Key (AES-256-GCM encryption for TOTP secrets)
# CRITICAL: MUST be set in production - no fallback allowed
# Generate: openssl rand -hex 32
MFA_ENCRYPTION_KEY="<GENERATE_32_BYTE_HEX_STRING>"

# API Key HMAC Secret (SHA-256 hashing for API keys)
# CRITICAL: MUST be set in production - no fallback allowed
# Generate: openssl rand -hex 32
API_KEY_SECRET="<GENERATE_32_BYTE_HEX_STRING>"

# Session Secret (Legacy - used as fallback for MFA if MFA_ENCRYPTION_KEY not set)
# Still required for Auth.js session encryption
# CRITICAL: MUST be set in production
SESSION_SECRET="<GENERATE_32_CHAR_RANDOM_STRING>"

# ============================================================================
# AI Providers - Vision (Cost-Optimized Routing)
# ============================================================================
# Gemini Flash 2.5 (85% of frames - $0.10/1M tokens)
GOOGLE_API_KEY="your-google-api-key"

# Claude 3.5 Sonnet (15% complex frames - $3/1M tokens)
ANTHROPIC_API_KEY="your-anthropic-api-key"

# OpenAI GPT-4o fallback
OPENAI_API_KEY="your-openai-api-key"

# ============================================================================
# AI Providers - LLM (Cost-Optimized Routing)
# ============================================================================
# GPT-4o-mini (70% - $0.15/1M input) + GPT-4o (30% - $2.50/1M input)
# Uses OPENAI_API_KEY above

# ============================================================================
# Feature Flags - AI Routing Strategy
# ============================================================================
# ZERO_DAY: Emergency fallback to proven OpenAI strategy
#
# ZERO_DAY=true  → Use OpenAI-only routing (stable, tested, 69% cost reduction)
#                   Fast:     GPT-4o-mini
#                   Balanced: GPT-4o
#                   Powerful: Claude Sonnet 3.5
#
# ZERO_DAY=false → Use Phase 12 documented strategy (77% cost reduction)
#                   Fast:     Gemini 1.5 Flash (free preview)
#                   Balanced: GPT-4o-mini
#                   Powerful: Claude Sonnet 4.5
#
# Default: false (use Phase 12 strategy)
# Set to true if Gemini provider has issues in production
ZERO_DAY=false

# ============================================================================
# AI Providers - Speech
# ============================================================================
# Deepgram Nova-3 (Speech-to-Text)
DEEPGRAM_API_KEY="your-deepgram-api-key"

# ElevenLabs Turbo v2.5 (Text-to-Speech - best quality)
ELEVENLABS_API_KEY="your-elevenlabs-api-key"

# Cartesia Sonic (TTS fallback)
CARTESIA_API_KEY="your-cartesia-api-key"

# ============================================================================
# AI Providers - Embeddings
# ============================================================================
# Voyage Multimodal-3 (RAG embeddings)
VOYAGE_API_KEY="your-voyage-api-key"

# ============================================================================
# AI Providers - Reranking (Phase 10)
# ============================================================================
# Cohere Rerank API (20-40% accuracy improvement, $2/1K searches)
COHERE_API_KEY="your-cohere-api-key"

# ============================================================================
# Real-time Video (WebRTC - Future: Janus Gateway)
# ============================================================================
# WebRTC server configuration placeholder
# Will be configured when Janus Gateway integration is implemented
# WEBRTC_URL="wss://your-janus-server.com"
# WEBRTC_API_KEY="your-webrtc-api-key"

# ============================================================================
# Backend Integration (Service-to-Service Auth)
# ============================================================================
# Backend API key for services to authenticate with backend
# Used for fetching tenant config, RAG queries, and cost tracking
BACKEND_API_KEY="<GENERATE_SECURE_API_KEY>"

# ============================================================================
# Phase 11: Storage Service Configuration (AWS S3)
# ============================================================================
# File upload and storage for chat attachments
# Get AWS credentials from: https://console.aws.amazon.com/iam/
AWS_S3_ACCESS_KEY_ID="<AWS_ACCESS_KEY_ID>"
AWS_S3_SECRET_ACCESS_KEY="<AWS_SECRET_ACCESS_KEY>"
AWS_S3_REGION="us-east-1"
AWS_S3_BUCKET="platform-chat-files-prod"
# AWS_S3_ENDPOINT="" # Optional: For S3-compatible services (MinIO, DigitalOcean Spaces, Cloudflare R2)

# ============================================================================
# Phase 11: Email Service Configuration (End-User Engagement)
# ============================================================================
# Resend for transactional emails (https://resend.com)
RESEND_API_KEY="re_your_resend_api_key"
RESEND_FROM_EMAIL="noreply@yourdomain.com"
RESEND_FROM_NAME="Your Platform Name"

# ============================================================================
# Email Validation Service (Emailable)
# ============================================================================
# Emailable for email validation to prevent bounces (https://emailable.com)
EMAILABLE_API_KEY="your-emailable-api-key"

# ============================================================================
# Phase 11: SMS Service Configuration (End-User Engagement)
# ============================================================================
# Choose ONE SMS provider (Twilio recommended for reliability)

# Option 1: Twilio
TWILIO_ACCOUNT_SID="your-twilio-account-sid"
TWILIO_AUTH_TOKEN="your-twilio-auth-token"
TWILIO_PHONE_NUMBER="+1234567890"

# Option 2: AWS SNS (Alternative - leave empty if using Twilio)
AWS_ACCESS_KEY_ID=""
AWS_SECRET_ACCESS_KEY=""
AWS_SNS_REGION=""
AWS_SNS_SENDER_ID=""

# ============================================================================
# Frontend Configuration (Vite - MUST be prefixed with VITE_)
# ============================================================================
# Backend service URLs
VITE_API_URL="http://localhost:3001"
VITE_REALTIME_URL="http://localhost:3002"
# VITE_WEBRTC_URL="wss://your-janus-server.com" # Future: Janus Gateway

# Application URLs (for cross-app navigation)
VITE_APP_URL="http://localhost:5173"
VITE_DASHBOARD_URL="http://localhost:5174"
VITE_MEET_URL="http://localhost:5175"
VITE_WIDGET_URL="http://localhost:5176"

